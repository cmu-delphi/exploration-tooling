---
title: COVID Forecaster Predictions
author: COVID Forecast Team
date: "Rendered: `r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    toc: True
    # self_contained: False
    # lib_dir: libs
params:
  forecast_generation_date: !r Sys.Date()
  forecast: !r ""
---

```{css, echo=FALSE}
body {
  display: block;
  max-width: 1280px !important;
  margin-left: auto;
  margin-right: auto;
}

body .main-container {
  max-width: 1280px !important;
  width: 1280px !important;
}
```

```{r setup, include=FALSE}
library(dplyr)
library(magrittr)
source(here::here("scripts", "plotting.R"))

exclude_geos <- c("as", "gu", "mp", "vi")
forecast <- params$forecast
assertthat::assert_that(tibble::is_tibble(forecast))
forecast %<>% mutate(forecaster = "epipredict")
```

## epipredict states

```{r, fig.height = 60, fig.width = 12, echo=FALSE}
plot_state_forecasters(
  forecast %>% filter(geo_value != "us"),
  exclude_geos
) %>%
  suppressMessages() %>%
  suppressWarnings()
```

## epipredict national

```{r, fig.height = 60, fig.width = 12, echo=FALSE}
plot_nation_forecasters(
  forecast %>%
    summarise(
      value = sum(value),
      .by = c("forecaster", "forecast_date", "target_end_date", "quantile")
    ) %>%
    mutate(geo_value = "us"),
  exclude_geos
) %>%
  suppressMessages() %>%
  suppressWarnings()
```
